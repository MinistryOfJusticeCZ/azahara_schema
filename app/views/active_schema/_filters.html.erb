<div id="filters" class="schema-filters">
  <div id="filters_uncollapsable">
    <% schema.uncollapsable_filters.each do |name, filter| %>
      <div class="form-group row filter" data-name="<%= name %>">
        <div class="col-4"><%= label_tag "f[#{name}]", t('activerecord.attributes.'+schema.model.name.underscore+'.'+name, default: name.humanize) %></div>
        <% if schema.operators_for(name).count > 1 %>
          <div class="col-2"><%= select_tag "f[#{name}]", options_for_select(operators_for_select(schema, name), schema.operator_for(name)), class: 'form-control operator-field' %></div>
          <div class="col-6">
            <%= filter_field(schema, filter) %>
          </div>
        <% else %>
          <div class="col-8">
            <%= hidden_field_tag "f[#{name}]", schema.operators_for(name).first, class: 'operator-field' %>
            <%= filter_field(schema, filter) %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
  <div class="clearfix">
    <button class="btn btn-sm btn-primary pull-right" data-toggle="collapse" data-target="#filters_collapsable"><%= t(:label_filters) %> <i class="fa fa-angle-double-down"></i></button>
  </div>
  <div id="filters_collapsable" class="collapse">
    <% schema.collapsable_filters.each do |name, filter| %>
      <div class="form-group row filter" data-name="<%= name %>">
        <div class="col-4"><%= label_tag "f[#{name}]", t('activerecord.attributes.'+schema.model.name.underscore+'.'+name, default: name.humanize) %></div>
        <% if schema.operators_for(name).count > 1 %>
          <div class="col-2"><%= select_tag "f[#{name}]", options_for_select(operators_for_select(schema, name), schema.operator_for(name)), class: 'form-control operator-field' %></div>
          <div class="col-6">
            <%= filter_field(schema, filter) %>
          </div>
        <% else %>
          <div class="col-8">
            <%= hidden_field_tag "f[#{name}]", schema.operators_for(name).first, class: 'operator-field' %>
            <%= filter_field(schema, filter) %>
          </div>
        <% end %>
      </div>
    <% end %>
    <% pp lookup_context.template_exists?("#{schema.model.model_name.plural}/_additional_filters") %>
    <% if lookup_context.template_exists?("#{schema.model.model_name.plural}/_additional_filters") %>
      <%= render "#{schema.model.model_name.plural}/additional_filters", schema: schema %>
    <% end %>
  </div>
</div>
